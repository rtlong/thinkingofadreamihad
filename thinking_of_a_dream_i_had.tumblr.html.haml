- Hamburglr::Tumblr::SAMPLE_DATA = false
- ASSET_HOST = 'http://wombat:4000'
!!!
%html{ 'xml:lang' => 'en', :lang => 'en', :xmlns => 'http://www.w3.org/1999/xhtml' }
  %head
    %meta{ :content => 'text/html; charset=utf-8', 'http-equiv' => 'Content-Type' }
    %title 
      - b :SearchPage do
        Search for: '#{search_query}' :
      - b :PostTitle do
        #{post_title} : 
      - b :PostSummary do
        #{post_summary} : 
      = title
      
    - meta_var :font, 'Content', 'Lucida Sans, Arial, Helvetica, sans-serif'
    - meta_var :font, 'Controls', 'Lucida Sans, Arial, Helvetica, sans-serif'
    - meta_var :image, 'Header', "#{ASSET_HOST}/images/title-800.png"
    %meta{ :name => 'description', :content => meta_description }
        
    %link{ :rel => :alternate, :type => 'application/rss+xml', :href => rss, :title => 'RSS' }
    %link{ :rel => :icon, :href => favicon }
    %link{ :rel => :prev, :href => previous_page, :title => 'Newer posts' }
    %link{ :rel => :next, :href => next_page,     :title => 'Older posts' }
    %link{ :rel => :stylesheet, :media => :screen, :href => "#{ASSET_HOST}/css/colorbox.css", :type => 'text/css' }
    %link{ :rel => :stylesheet, :media => :all,    :href => "#{ASSET_HOST}/css/styles.css", :type => 'text/css' }
    %script{ :src => 'http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js', :type => 'text/javascript' }
    %script{ :src => "#{ASSET_HOST}/js/jquery.colorbox-min.js", :type => 'text/javascript' }
    %script{ :src => "#{ASSET_HOST}/js/jquery.infinitescroll.min.js", :type => 'text/javascript' }
    
    :javascript
      // Creating custom :external selector
      $.expr[':'].external = function(obj){
          return !obj.href.match(/^mailto\:/)
                  && (obj.hostname != location.hostname);
      };

      // Add 'external' CSS class to all external links
      $('a:external').addClass('external');
      
      function setUpColorbox(){
        $(".photo-post .photo a").colorbox({
          maxWidth: '98%',
          maxHeight: '98%',
          photo: true,
          transition: 'fade', 
          opacity: 1.0,
          current: '{'+'current'+'} of {'+'total'+'}',
          previous: '<span>previous</span>',
          next: '<span>next</span>',
          close: '<span>close</span>'
        });
      }
    
      $(document).ready(setUpColorbox);
      
      $('#posts').infinitescroll({
        navSelector: '#pagination',
        nextSelector: '#next_page',
        itemSelector: '#posts .post'
      }, setUpColorbox);

    %style{ :type => 'text/css' } 
      :sass
        body
          :font-family #{font :Controls}
          
        #q
          :background-image url("#{ASSET_HOST}/images/search_32.png")
        
        #colorbox
          #cboxLoadingGraphic
            :background-image url("#{ASSET_HOST}/images/loading.gif")
          #cboxSlideshow, #cboxPrevious, #cboxNext, #cboxClose
            :background-image url("#{ASSET_HOST}/images/controls.png")
            
      = custom_css
  %body
    #title
      %a{ :href => '/' }
        - b :IfHeaderImage do
          %img{ :src => image(:Header), :alt => title }
        - b :IfNotHeaderImage do
          = title
    #content
      - b :TagPage do
        %h2#tag_page_label Posts tagged <em>#{tag}</em>
      - b :DayPage do
        %h2#day_page_label Posts from #{day_of_month} #{month} #{year}
      - b :SearchPage do
        #search_result_count
          .back
            %a{:href => '/'} Cancel Search
          - b :SearchResults do
            #{search_result_count} results found for "#{search_query}"
          - b :NoSearchResults do
            No results found for "#{search_query}"
          
      #posts
        - b :Posts do
          .post{ :id => post_id, :class => tags_as_classes }
            - b :Text do
              .text-post
                - b :Title do
                  %h1= title
                - b :NoTitle do
                  %h1.hidden Post
                = body
            
            - b :Link do
              .link-post
                .link
                  %h1
                    %a.external{ :href => url, :target => target }= name
                %a.href{ :href => url, :target => target }= url
                - b :Description do
                  .caption= description
            
            - b :Photo do
              .photo-post
                %h1.hidden Photo 
                .photo
                  %a{ :href => photo_url_high_res, :title => photo_alt, :rel => "photo_post" }
                    %img{ :src => photo_url_500, :alt => photo_alt }
                - b :Caption do
                  .caption= caption
            
            - b :PhotoSet do
              .photoset-post
                %h1.hidden Photoset
                .photo= photoset_500
                - b :Caption do
                  .caption= caption
            
            - b :Quote do
              .quote-post
                %blockquote.quote{:class => length}<
                  %span.marks>< &ldquo;
                  = quote
                  %span.marks>< &rdquo;
                - b :Source do 
                  .source<
                    &mdash;&nbsp;
                    %cite= source
                    
            - b :Answer do 
              .answer-post
                .question
                  .icon Q:
                  %h4
                    %span.marks>< &ldquo;
                    = question
                    %span.marks>< &rdquo;
                  .asker
                    %cite
                      %img.avatar{:src => asker_portrait_url_16}
                      = asker
                .answer
                  .icon A:
                  %h4= answer
                
            .info
              %div
                %span.date
                  - b :Reblog do
                    Reblogged
                  - b :NotReblog do
                    Posted
                  %span.posted_at
                    %a{ :href => "/day/#{year}/#{month_number_with_zero}/#{day_of_month}", :title => "All posts from this day" } #{day_of_month} #{month} #{year}
                    - b :DayPage do
                      :javascript
                        $('##{post_id} .posted_at')[0].innerHTML = "at #{var '24_hour_with_zero'}:#{minutes}";
                  - b :Reblog do
                    %span.reblog_info
                      from 
                      %a{ :href => reblog_parent_url } #{reblog_parent_title}
                      - b :RebloggedFromReblog do
                        (originally from 
                        %a{:href => reblog_root_url }>= reblog_root_title
                        )
                - b :IndexPage do
                  &bull;
                  %span.permalink
                    %a{ :href => permalink, :title => note_count_with_label, :rel => :bookmark }= note_count_with_label
                    
              - b :HasTags do
                .tags
                  Tagged: 
                  %ul
                    - b :Tags do
                      %li
                        %a{:href => tag_url_chrono}= tag
                        
              - b :PostNotes do
                .notes
                  %h2= note_count_with_label
                  = post_notes
                  
  
          - b :IndexPage do
            %hr/
            
      #footer
        - b :Pagination do
          #pagination
            - b :PreviousPage do
              %a.arrow_nav#previous_page{ :href => previous_page, :title => 'Newer posts' } &larr;
            %span.status Page #{current_page} of #{total_pages}
            - b :NextPage do
              %a.arrow_nav#next_page{ :href => next_page, :title => 'Older posts' } &rarr;
              
        - b :PermalinkPagination do
          #pagination
            - b :PreviousPost do
              %a.nav#previous_page{ :href => previous_post, :title => 'Newer Post' } Newer Post
              - b :NextPost do  
                |
            - b :NextPost do
              %a.nav#next_page{ :href => next_post, :title => 'Older Post' } Older Post
        
        - b :DayPagination do
          #pagination
            - b :PreviousDayPage do
              %a.nav#previous_page{ :href => previous_day_page, :title => '#{year}-#{month_number_with_zero}-#{day_of_month}' } #{short_month} #{day_of_month}
              - b :NextDayPage do
                |
            - b :NextDayPage do
              %a.nav#next_page{ :href => next_day_page, :title => '#{year}-#{month_number_with_zero}-#{day_of_month}' } #{short_month} #{day_of_month}

        #back_to_index
          %a{ :href => "/" } Home
    
    #sidebar
      #search
        %form{ :method => 'get', :action => '/search' }
          %input#q{ :name => 'q', :type => 'text', :value => search_query }
      #description
        = description
      %ul#meta
        %li
          %a{ :href => "http://www.tumblr.com/follow/{Name}" } Follow
          Me
        %li
          See something
          %a{ :href => "/random" } Random
        %li
          Browse my
          %a{ :href => '/archive' } Archive
        %li
          Get the 
          %a{ :href => rss } RSS Feed
          
